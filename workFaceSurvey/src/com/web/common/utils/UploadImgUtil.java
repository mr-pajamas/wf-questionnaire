package com.web.common.utils;

import java.io.File;
import java.io.IOException;
import java.util.HashMap;
import java.util.Map;

import sun.misc.BASE64Decoder;

import com.qiniu.common.QiniuException;
import com.qiniu.http.Response;
import com.qiniu.storage.UploadManager;
import com.qiniu.util.Auth;

public class UploadImgUtil {

	String ACCESS_KEY = "ArTWIe1q_1iDUdMm2notK3vjhARjbcNa_8S1zrZ5";
	String SECRET_KEY = "N9fwW3xXTNvUCdBKQqtcYZsUmaDquwSK1xh9anFv";
	
	
	
	Auth auth = Auth.create(ACCESS_KEY, SECRET_KEY);

	private String getUpToken0(String key) {
		//return auth.uploadToken("wf-photos", key);
		String token=auth.uploadToken("wf-photos", key);
		System.out.println(token);
		 return token;
	}
	
	private byte[] decode(String imageData) throws IOException{
		BASE64Decoder decoder = new BASE64Decoder();
		byte[] data = decoder.decodeBuffer(imageData);
		return data;
	}
	
	public static void updateImg(String img,String keyname){
		
	}
	

	public static void main(String[] args) {
		UploadImgUtil util=new UploadImgUtil();
	   UploadManager uploadManager = new UploadManager();
	   String key="ceshi.jsp";
		 File file=new File("c:/wangyc.jpg");
	   String tp=new String("data:image/jpeg;base64,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");
		try {
			
			Response res= uploadManager.put(util.decode(tp.substring("data:image/jpeg;base64,".length())), key, util.getUpToken0(key));
	
			Map<String, Object> m4 = res.jsonToObject(HashMap.class);
			System.out.println(111);
		} catch (QiniuException e) {
			Response r = e.response;
			System.out.println(r.toString());
			try {
				System.out.println(r.bodyString());
			} catch (QiniuException e1) {
				// TODO Auto-generated catch block
				e1.printStackTrace();
			}
		}catch (Exception e) {
			// TODO: handle exception
		}
	}
}
